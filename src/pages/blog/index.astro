---
// src/pages/blog/index.astro
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

// 获取所有博客文章，不进行排序
const allPosts = await getCollection('blog');

console.log("所有文章数据:", allPosts);


---

<BaseLayout 
    title="博客文章" 
    description="探索技术文章和教程"
>
    <div class="max-w-4xl mx-auto p-4 sm:p-8">
        <!-- 页面主标题 -->
        <h1 class="text-4xl font-extrabold mb-10 text-center text-gray-900 dark:text-white">
            博客文章
        </h1>

        <!-- 文章列表容器 -->
        <section class="space-y-6">
            {
                allPosts.map((post) => (
                    <a 
                        href={`/blog/${post.slug}/`}
                        class="block border border-gray-200 rounded-xl p-5 transition duration-300 ease-in-out bg-white hover:bg-gray-50 shadow-lg dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700"
                    >
                        <article>
                            <!-- 文章标题 -->
                            <h2 class="text-2xl font-bold text-indigo-700 dark:text-indigo-400 mb-2">
                                {post.data.title}
                            </h2>
                            
                            <!-- 发布日期和作者信息 -->
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400 mb-3 space-x-4">
                                <span>•</span>
                                <span>作者: {post.data.author}</span>
                                {post.data.readingTime && (
                                    <>
                                        <span>•</span>
                                        <span>阅读时间: {post.data.readingTime} 分钟</span>
                                    </>
                                )}
                            </div>
                            
                            <!-- 文章描述/摘要 -->
                            <p class="text-base text-gray-700 dark:text-gray-300 line-clamp-2 mb-3">
                                {post.data.description}
                            </p>
                            
                            <!-- 标签 -->
                            {post.data.tags && post.data.tags.length > 0 && (
                                <div class="flex flex-wrap gap-2">
                                    {post.data.tags.slice(0, 3).map((tag) => (
                                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300">
                                            #{tag}
                                        </span>
                                    ))}
                                    {post.data.tags.length > 3 && (
                                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300">
                                            +{post.data.tags.length - 3}
                                        </span>
                                    )}
                                </div>
                            )}
                        </article>
                    </a>
                ))
            }
        </section>
        
        <!-- 列表为空时的提示 -->
        {allPosts.length === 0 && (
            <div class="text-center py-12">
                <p class="text-xl text-gray-500 dark:text-gray-400 mb-4">
                    还没有发布任何文章
                </p>
                <p class="text-sm text-gray-400 dark:text-gray-500">
                    敬请期待...
                </p>
            </div>
        )}
        
        <!-- 文章计数 -->
        <div class="text-center mt-8 text-sm text-gray-500 dark:text-gray-400">
            共 {allPosts.length} 篇文章
        </div>
    </div>
</BaseLayout>