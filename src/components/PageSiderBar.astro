---
import { contentUtils } from "@/lib/utils/textConverter";

const { tags, categories, allCategories } = Astro.props;
---

<div class="w-full lg:w-80 fixed lg:top-4">  <!-- 粘性定位 -->
    <!-- categories -->
    <div class="mb-8">
        <h5 class="mb-6 flex items-center gap-2">  <!-- Flex 标题 -->
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M17 10a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v5zM5 5h10v5H5V5z" clip-rule="evenodd"/>
            </svg>
            类别
        </h5>
        <div class="rounded bg-light p-6 dark:bg-darkmode-light">
            <ul class="flex flex-col gap-3">
                {
                    categories.map((category: any) => {
                        const count = allCategories.filter(
                            (c: any) => c === category,
                        ).length;
                        return (
                            <li class="flex group">
                                <a
                                    class="flex justify-between items-center w-full p-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"
                                    href={`/categories/${category}`}
                                >
                                    <span class="flex items-center gap-2">
                                        <span class="w-2 h-2 bg-primary rounded-full"></span>
                                        {contentUtils.formatTaxonomy(category)}
                                    </span>
                                    <span class="bg-gray-100 dark:bg-gray-600 px-2 py-1 rounded text-xs font-medium">
                                        {count}
                                    </span>
                                </a>
                            </li>
                        );
                    })
                }
            </ul>
        </div>
    </div>
    
    <!-- tags -->
    <div class="mb-8">
        <h5 class="mb-6 flex items-center gap-2">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M17.707 9.293l-5-5A1 1 0 0012 4H4a1 1 0 00-1 1v12a1 1 0 001 1h12a1 1 0 001-1v-8a1 1 0 00-.293-.707zM10 14a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
            </svg>
            标签
        </h5>
        <div class="rounded bg-light p-6 dark:bg-darkmode-light">
            <ul class="flex flex-wrap gap-2">
                {
                    tags.map((tag: any) => {
                        return (
                            <li>
                                <a
                                    class="inline-flex items-center rounded-full bg-white px-3 py-1 text-sm hover:bg-primary hover:text-white dark:bg-darkmode-body dark:hover:bg-darkmode-primary transition-all hover:scale-105"
                                    href={`/tags/${tag}`}
                                >
                                    #{contentUtils.formatTaxonomy(tag)}
                                </a>
                            </li>
                        );
                    })
                }
            </ul>
        </div>
    </div>
</div>